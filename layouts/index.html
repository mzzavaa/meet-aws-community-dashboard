{{ define "main" }}
    {{ $userGroupsCSV := "data/aws_user_groups_complete.csv" | absURL }}
    {{ $buildersCSV := "data/community_builders_complete.csv" | absURL }}
    
    <div class="content">
        <h1>{{ .Title }}</h1>
        <p>{{ .Description }}</p>
        
        {{ .Content }}
        
        <div class="stats">
            <div class="stat-card">
                <div class="stat-number" id="totalUserGroups">0</div>
                <div class="stat-label">User Groups</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="totalBuilders">0</div>
                <div class="stat-label">Community Builders</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="totalCountries">0</div>
                <div class="stat-label">Countries</div>
            </div>
        </div>
        
        <div id="worldMap" style="height: 500px; width: 100%; border-radius: 8px; margin: 2rem 0;"></div>
        
        <!-- Heroes Section -->
        <div class="heroes-section">
            <h2>AWS Heroes</h2>
            <p>Learn from AWS Heroes who are passionate about sharing knowledge and helping others.</p>
            <div class="grid">
                <div class="card">
                    <h3>Meet the Heroes</h3>
                    <p>Discover AWS Heroes who are recognized for their technical expertise and community contributions.</p>
                    <p><a href="{{ "heroes" | relURL }}">Browse Heroes →</a></p>
                </div>
                <div class="card">
                    <h3>Featured Hero</h3>
                    <div id="featuredHero">
                        <div class="featured-hero-card">
                            <div class="hero-avatar">
                                <img src="{{ "images/heroes/chris-williams.jpg" | relURL }}" alt="Chris Williams" onerror="this.src='{{ "images/default-avatar.png" | relURL }}'">
                            </div>
                            <div class="hero-info">
                                <h4>Chris Williams</h4>
                                <div class="hero-category">AWS Community Hero</div>
                                <p>Developer Relations Manager at HashiCorp, AWS User Group Leader</p>
                                <a href="{{ .Site.BaseURL }}interviews/chris-williams/" class="hero-link">Read Interview →</a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="card">
                    <h3>Featured Hero</h3>
                    <div id="featuredHero2">
                        <div class="featured-hero-card">
                            <div class="hero-avatar">
                                <img src="{{ "images/heroes/default-hero.jpg" | relURL }}" alt="Featured Hero" onerror="this.src='{{ "images/default-avatar.png" | relURL }}'">
                            </div>
                            <div class="hero-info">
                                <h4>Jane Smith</h4>
                                <div class="hero-category">AWS Container Hero</div>
                                <p>DevOps Engineer, Speaker, and Open Source Contributor</p>
                                <a href="#" class="hero-link">View Profile →</a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="explore-all-card">
                    <a href="{{ "heroes" | relURL }}" class="explore-all-link">
                        <i class="fas fa-users"></i>
                        <span>Explore All Heroes</span>
                        <i class="fas fa-arrow-right"></i>
                    </a>
                </div>
            </div>
        </div>
        
        <div class="user-groups">
            <h2>AWS User Groups</h2>
            <p>Connect with local AWS enthusiasts through AWS User Groups in your area.</p>
            <div class="grid">
                <div class="card">
                    <h3>Find a User Group</h3>
                    <p>Join an AWS User Group to network with peers, learn from experts, and share your knowledge.</p>
                    <p><a href="{{ "user-groups" | relURL }}">Browse User Groups →</a></p>
                </div>
                <div class="card">
                    <h3>Featured User Group</h3>
                    <div id="featuredUserGroup">Loading...</div>
                </div>
                <div class="card">
                    <h3>Featured User Group</h3>
                    <div id="featuredUserGroup2">
                        <h4>AWS User Group - Berlin</h4>
                        <p><strong>Location:</strong> Berlin, Germany</p>
                        <p><strong>Members:</strong> 1,200+</p>
                        <p><strong>Founded:</strong> 2015</p>
                        <p><a href="#">Visit Group →</a></p>
                    </div>
                </div>
                <div class="explore-all-card">
                    <a href="{{ "user-groups" | relURL }}" class="explore-all-link">
                        <i class="fas fa-users"></i>
                        <span>Explore All User Groups</span>
                        <i class="fas fa-arrow-right"></i>
                    </a>
                </div>
            </div>
        </div>
        
        <div class="community-builders">
            <h2>AWS Community Builders</h2>
            <p>Discover content creators and technical experts in the AWS Community Builders program.</p>
            <div class="grid">
                <div class="card">
                    <h3>Meet the Builders</h3>
                    <p>Learn from AWS Community Builders who share their knowledge through blogs, videos, and more.</p>
                    <p><a href="{{ "community-builders" | relURL }}">Browse Community Builders →</a></p>
                </div>
                <div class="card">
                    <h3>Featured Community Builder</h3>
                    <div id="featuredBuilder">Loading...</div>
                </div>
                <div class="card">
                    <h3>Featured Community Builder</h3>
                    <div id="featuredBuilder2">
                        <h4>Alex Johnson</h4>
                        <p><strong>Category:</strong> Machine Learning</p>
                        <p><strong>Location:</strong> Toronto, Canada</p>
                        <p><a href="#">View Profile →</a></p>
                    </div>
                </div>
                <div class="explore-all-card">
                    <a href="{{ "community-builders" | relURL }}" class="explore-all-link">
                        <i class="fas fa-users"></i>
                        <span>Explore All Community Builders</span>
                        <i class="fas fa-arrow-right"></i>
                    </a>
                </div>
            </div>
        </div>
        
        <div class="interviews-section">
            <h2>Community Interviews</h2>
            <p>Get to know AWS community members through in-depth interviews.</p>
            <div class="grid">
                <div class="card">
                    <h3>Featured Interview</h3>
                    <div class="featured-interview">
                        <h4>Chris Williams</h4>
                        <p>From Pre-Med to Cloud Architecture</p>
                        <div class="interview-roles">
                            <span class="role-badge">AWS Hero</span>
                            <span class="role-badge">User Group Leader</span>
                        </div>
                        <p><a href="{{ .Site.BaseURL }}interviews/chris-williams/">Read Interview →</a></p>
                    </div>
                </div>
                <div class="card">
                    <h3>Latest Interviews</h3>
                    <ul class="interview-list">
                        <li><a href="{{ .Site.BaseURL }}interviews/chris-williams/">Chris Williams: From Pre-Med to Cloud Architecture</a></li>
                        <li><a href="#">Jane Smith: Building Serverless Applications</a></li>
                        <li><a href="#">Alex Johnson: Machine Learning Journey</a></li>
                    </ul>
                </div>
                <div class="explore-all-card">
                    <a href="{{ .Site.BaseURL }}interviews/" class="explore-all-link">
                        <i class="fas fa-microphone-alt"></i>
                        <span>Explore All Interviews</span>
                        <i class="fas fa-arrow-right"></i>
                    </a>
                </div>
            </div>
        </div>
    </div>
    
    <style>
    .heroes-section {
        border-left: 4px solid var(--aws-orange);
        padding-left: 1rem;
        margin: 2rem 0;
    }
    
    .heroes-section h2 {
        color: var(--aws-orange);
    }
    
    body.dark-mode .heroes-section h2 {
        color: var(--aws-orange);
    }
    
    .interviews-section {
        border-left: 4px solid var(--aws-purple);
        padding-left: 1rem;
        margin: 2rem 0;
    }
    
    .interviews-section h2 {
        color: var(--aws-purple);
    }
    
    body.dark-mode .interviews-section h2 {
        color: #b87dd1;
    }
    
    .featured-hero-card {
        display: flex;
        align-items: center;
        gap: 1rem;
    }
    
    .hero-avatar {
        width: 80px;
        height: 80px;
        border-radius: 50%;
        overflow: hidden;
        flex-shrink: 0;
    }
    
    .hero-avatar img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }
    
    .hero-info h4 {
        margin-top: 0;
        margin-bottom: 0.5rem;
    }
    
    .hero-category {
        background-color: var(--aws-orange);
        color: white;
        display: inline-block;
        padding: 0.25rem 0.5rem;
        border-radius: 4px;
        font-size: 0.8rem;
        margin-bottom: 0.5rem;
    }
    
    .hero-link {
        display: inline-block;
        margin-top: 0.5rem;
    }
    
    .interview-list {
        padding-left: 1.5rem;
    }
    
    .interview-list li {
        margin-bottom: 0.5rem;
    }
    
    .explore-all-card {
        display: flex;
        align-items: center;
        justify-content: center;
        background-color: #f9f9f9;
        border-radius: 8px;
        padding: 1.5rem;
        transition: background-color 0.3s ease;
    }
    
    body.dark-mode .explore-all-card {
        background-color: var(--dark-surface);
    }
    
    .explore-all-link {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        font-weight: 600;
        color: var(--aws-dark-blue);
        transition: color 0.3s ease;
    }
    
    body.dark-mode .explore-all-link {
        color: var(--dark-text);
    }
    
    .explore-all-link:hover {
        color: var(--aws-orange);
        text-decoration: none;
    }
    
    .explore-all-link i:last-child {
        transition: transform 0.3s ease;
    }
    
    .explore-all-link:hover i:last-child {
        transform: translateX(5px);
    }
    </style>
    
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        console.log('Home page loaded, initializing...');
        
        // Function to parse CSV
        function parseCSV(text) {
            try {
                const lines = text.split('\n');
                const headers = lines[0].split(',').map(h => h.trim());
                
                return lines.slice(1)
                    .filter(line => line.trim())
                    .map(line => {
                        // Handle commas within quoted fields
                        const values = [];
                        let inQuotes = false;
                        let currentValue = '';
                        
                        for (let i = 0; i < line.length; i++) {
                            const char = line[i];
                            
                            if (char === '"') {
                                inQuotes = !inQuotes;
                            } else if (char === ',' && !inQuotes) {
                                values.push(currentValue);
                                currentValue = '';
                            } else {
                                currentValue += char;
                            }
                        }
                        
                        values.push(currentValue);
                        
                        // Create object from headers and values
                        const entry = {};
                        headers.forEach((header, i) => {
                            entry[header] = values[i] ? values[i].replace(/^"(.*)"$/, '$1') : '';
                        });
                        
                        return entry;
                    });
            } catch (error) {
                console.error('Error parsing CSV:', error);
                return [];
            }
        }
        
        // Rest of your existing JavaScript...
    });
    </script>
{{ end }}
